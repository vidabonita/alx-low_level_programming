more of the nested function
